extends layout

block content
  nav.navbar.navbar-expand-lg.navbar-dark.bg-dark.fixed-top.justify-content-between
    a.navbar-brand(style='color: #fff') NHL Playoffs 2018
    button.navbar-toggler(type='button' data-toggle='collapse' data-target='#navbar')
      span.navbar-toggler-icon
    div.collapse.navbar-collapse#navbar
      ul.navbar-nav.ml-auto
        li.nav-item
          a.nav-link(href='/') Brackets
        li.nav-item
          a.nav-link(href='/standings') Standings
  div.container-fluid(style="padding-top:60px;" ng-controller='SeriesController')
    div.row.justify-content-center
      h3.text-center Series

    div.row(style='margin:auto;' ng-repeat="member in series track by $index")
      div.col
        div.card(style="padding-bottom: 0px;")
          div.card-header(ng-click='toggle("#series" + $index);' style='cursor: pointer;')
            div.bmd-list-group-col(ng-if="member.team1_id && member.team2_id")
              h6 {{member.team1_id}} v. {{member.team2_id}}: {{!member.enabled ? 'Finished' : 'Ongoing'}}
              p {{!member.enabled ? 'Final' : 'Current'}} Score: {{calculateScore(member)}} {{!member.enabled ? member.winner : ''}}
              i.text-center.material-icons {{member.expanded ? 'keyboard_arrow_up' : 'keyboard_arrow_down'}}
            div.bmd-list-group-col(ng-if="!member.team1_id || !member.team2_id")
              h6 FUTURE GAME
              i.text-center.material-icons keyboard_arrow_down
          div.collapse(id="series{{$index}}", ng-class="{show: member.enabled}")
            table.table
              thead
                tr
                  th Game #
                  th Matchup
              tbody
                - var i = 1;
                while i < 8
                  tr
                    td= i
                    td
                      - var model = "member['game" + (i) + "']";
                      //i.material-icons(style="padding-right: 5px; margin-left: -29px; cursor: pointer;" ng-if="member.enabled && member.lastInput == " + i ng-click="updateDB(member.id, " + i + ", null)") replay
                      p(style="display:inline; padding-right: 5px; margin-left: -29px; cursor: pointer;" ng-if="member.enabled && member.lastInput == " + i ng-click="updateDB(member.id, " + i + ", null)") edit
                      div.btn-group.selection-buttons(style="box-shadow: none; background-color: transparent;")
                        button.btn.btn-lg.btn-secondary.btn-outline(type="button" ng-style="{'background-color': " + model + "== member.team1_id || (member['game" + i + "_enabled'] && member.enabled) ? member.team1_color : ''}" ng-disabled="!member.enabled || !member['game" + i + "_enabled']" ng-class="{active: " + model + "== member.team1_id, bg_color: member.team1_id && " + model + "== member.team1_id || (member['game" + i + "_enabled'] && member.enabled)}" ng-click="updateDB(member.id, " + i + ", member.team1_id)") {{member.team1_id ? member.team1_id : 'TBD'}}
                        button.btn.btn-lg.btn-secondary.btn-outline(type="button" ng-style="{'background-color': " + model + "== member.team2_id || (member['game" + i + "_enabled'] && member.enabled) ? member.team2_color : ''}" ng-disabled="!member.enabled || !member['game" + i + "_enabled']" ng-class="{active: " + model + "== member.team2_id, bg_color: member.team2_id && " + model + "== member.team2_id || (member['game" + i + "_enabled'] && member.enabled)}" ng-click="updateDB(member.id, " + i + ", member.team2_id)") {{member.team2_id ? member.team2_id : 'TBD'}}
                      - i++;
    div.modal.fade#winnerModal(tabindex="-1")
      div.modal-dialog.modal-sm.modal-dialog-centered
        div.modal-content
          div.modal-header
            h5.modal-title Winner!
          div.modal-body
            p#winningText -
          div.modal-footer
            button.btn.btn-secondary(type="button" data-dismiss="modal" ng-click="ignoreLast()") Cancel
            button.btn.btn-primary(type="button" data-dismiss="modal" ng-click="closeOut()") Confirm
  script.
      const SERIES = !{JSON.stringify(series)};
      const BRACKETS = !{JSON.stringify(brackets)};
      const TEAMS = !{JSON.stringify(teams)};